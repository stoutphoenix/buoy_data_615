---
title: "buoy_data_615"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
data <- read.table('data/2023.txt')
colnames(data) <- c('YY','MM','DD','hh', 'mm', 'WDIR', 'WSPD', 'GST', 'WVHT','DPD','APD', 'MWD', 'PRES','ATMP', 'WTMP', 'DEWP', 'VIS','TIDE')
```

You can add options to executable code like this

```{r}
summary(data)
```

Is wind speed and pressure correlated?

```{r}
pacman::p_load(dplyr, ggplot2)
wind <- data$WSPD
pressure <- data$PRES
df <- data.frame(wind, pressure)

df <- df %>%
  filter(wind<99 & pressure<9999) %>%
  filter(!is.na(wind) | !is.na(pressure))

df$pressure <- df$pressure - mean(df$pressure)
set.seed(123)
random_subset <- df %>% slice_sample(n = 1000)

model <- lm(wind ~ pressure, df)
summary(model)
b <- coef(model)[1] # Intercept
m <- coef(model)[2] # Slope

ggplot(random_subset) +
  aes(x = pressure, y = wind) +
  geom_point(colour = alpha("#112446", 0.25)) +
  theme_minimal() +
  geom_abline(intercept = b, slope = m, colour = "red") +
  labs(title = "Wind Speed as a Function of Pressure",
       caption = "Caption or source info",
       x = "Pressure (hPa)",
       y = "Wind Speed (m/s)")
```

Our model indicates a correlation of -0.027 when predicting wind speed from pressure. This means for every unit increase of pressure (hPa), the wind speed is expected to decrease by 0.027 m/s. Our model indicates wind speed to be a statistically significant predictor with a very low p-value of 2e-16, however the adjusted R\^2 of 0.0065 indicates it is not a very useful predictor as only 0.65% of the variance in wind speed can be explained from pressure.
