---
title: "buoy_data_615"
format: html
editor: visual
---

# An Analysis on NDBC Buoy 44013

### Loading and cleaning 2023 data:

```{r}
pacman::p_load(dplyr, ggplot2)

data <- read.table('data/2023.txt')
colnames(data) <- c('YY','MM','DD','hh', 'mm', 'WDIR', 'WSPD', 'GST', 'WVHT','DPD','APD', 'MWD', 'PRES','ATMP', 'WTMP', 'DEWP', 'VIS','TIDE')

# This analysis will focus on wind speed and pressure
data <- data %>%
  filter(WSPD<99) %>%
  filter(PRES<9999)

summary(data)
```

### Model Wind Speed as a Function of Pressure

```{r}
df <- data.frame(data$WSPD, data$PRES)
colnames(df) <- c('wind', 'pressure')

df <- df %>%
  filter(!is.na(wind) | !is.na(pressure))

df$pressure <- df$pressure - mean(df$pressure)
set.seed(123)
random_subset <- df %>% slice_sample(n = 1000)

model <- lm(wind ~ pressure, df)
summary(model)
b <- coef(model)[1] # Intercept
m <- coef(model)[2] # Slope

b <- as.numeric(b)
m <- as.numeric(m)

eq = paste('y=',round(m,3),'x+',round(b,3))

ggplot(random_subset) +
  aes(x = pressure, y = wind) +
  geom_point(colour = alpha("#112446", 0.25)) +
  theme_minimal() +
  geom_abline(intercept = b, slope = m, colour = "red") +
  annotate("text", x = -26, y = m*-25+b+1, 
           label = eq, size = 4, color='red') +
  labs(title = "Wind Speed as a Function of Pressure",
       caption = "Caption or source info",
       x = "Pressure (hPa)",
       y = "Wind Speed (m/s)")
```

Our model indicates a correlation of -0.027 when predicting wind speed from pressure. This means for every unit increase of pressure (hPa), the wind speed is expected to decrease by 0.027 m/s. Our model indicates wind speed to be a statistically significant predictor with a very low p-value of 2e-16, however the adjusted R\^2 of 0.0065 indicates it is not a very useful predictor as only 0.65% of the variance in wind speed can be explained from pressure.
